;; This is such a hack! XD
#(__defmacro __declare (identifier type &rest script-body) ())

__declare print (I)

__defun + (a &rest b)
        __if b
             __+ a (__apply #self b)
             a
__declare + (I &rest 1 I)

__defun * (a &rest b)
        __if b
             (__* a (__apply #self b))
             a
__declare * (I &rest 1 I)

(__defun println (arg)
         print arg
         print "\n"
         arg)

__defun list (&rest args) args
__defun cons (a d) __cons a d
__defun car (c) __car c
__defun cdr (c) __cdr c

__defun funcall (f &rest args) __apply f args
__declare funcall (I &rest 1 I)

__defun map (f l)
        __if l
             cons (#f car l)
                  (funcall #self f cdr l)
             ()

__defun reduce (f l) __apply f l

println __quote print
println + + 1 2
          + 3 4
println (+ 1 2 3 4)
println * 2 reduce #+ (list 1 2 3 4)
println reduce #+ map __lambda (x) * 2 x (list 1 2 3 4)

__defun f (a b) (cons a b)
__declare f (I I)
__defun g (a b) (cons a b)
__declare g (L I)

println f list 3
println g list 3
println (f list 3)
println (g list 3)
println #f list 3
println #g list 3
println (#f list 3)
println (#g list 3)
println #(f list 3)
println #(g list 3)
println ""
println f (list list 3) 3
println g (list list 3) 3
println (f (list list 3) 3)
println (g (list list 3) 3)
println (#f (list list 3) 3)
println (#g (list list 3) 3)
println #(f (list list 3) 3)
println #(g (list list 3) 3)

__defun x () "Llama comma"
println x
